<!DOCTYPE html>
<html>
  <head>
    <title>Temporary Text</title>
    <link rel="manifest" href="text.webmanifest">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Temporary text editor">
    <meta name="theme-color" content="#000000">
    <style>
    body {
      margin: 0 0;
      height: 100%;
    }

    select {
      width: 100%;
    }

    textarea {
      width: 100%;
      height: 100vh;
    }
    </style>
  </head>
  <body>
    <main>
      <form>
        <select onchange="handleCommandEvent(event)">
          <option disabled selected>Command</option>
          <option value="countCharacters">Count Characters</option>
          <option value="countLines">Count Lines</option>
          <option value="everyOtherEven">Every Other (Even)</option>
          <option value="everyOtherOdd">Every Other (Odd)</option>
          <option value="filter">Filter</option>
          <option value="filterInverse">Filter Inverse</option>
          <option value="join">Join</option>
          <option value="replace">Replace</option>
          <option value="reverse">Reverse</option>
          <option value="sortLexically">Sort Lexically</option>
          <option value="sortNumerically">Sort Numerically</option>
          <option value="split">Split</option>
          <option value="toLowerCase">To Lower Case</option>
          <option value="toUpperCase">To Upper Case</option>
          <option value="trim">Trim</option>
          <option value="trimEnd">Trim End</option>
          <option value="trimStart">Trim Start</option>
        </select>
        <textarea autofocus id="text"></textarea>
      </form>
    </main>
  </body>
  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("/sw.js");
  }

  class Commands {
    static countLines(lines) {
      alert(`Lines: ${lines.length}`)

      return lines
    }
    
    static countCharacters(lines) {
      let characters = lines.reduce((sum, line) => sum + line.length, 0)

      alert(`Characters: ${characters}`)

      return lines
    }

    static everyOtherEven(lines) {
        return lines.filter((line, index) => index % 2 == 0)
    }

    static everyOtherOdd(lines) {
        return lines.filter((line, index) => index % 2 == 1)
    }

    static filter(lines) {
      let pattern = prompt("Pattern?")

      return lines.filter((line) => line.match(pattern))
    }

    static filterInverse(lines) {
      let pattern = prompt("Pattern?")

      return lines.filter((line) => !line.match(pattern))
    }

    static join(lines) {
        let joiner = prompt("Joiner?")

        return lines.join(joiner).split("\n")
    }

    static replace(lines) {
      let pattern = prompt("Pattern?")
      let replacement = prompt("Replacement?")

      return lines.map((line) => line.replace(pattern, replacement))
    }

    static reverse(lines) {
      return lines.reverse()
    }

    static sortLexically(lines) {
      return lines.sort()
    }

    static sortNumerically(lines) {
      return lines.sort((left, right) => parseInt(left, 10) - parseInt(right, 10))
    }

    static split(lines) {
        let pattern = prompt("Pattern?") 

        return lines.join("\n").split(pattern)
    }

    static toLowerCase(lines) {
        return lines.map((line) => line.toLowerCase())
    }

    static toUpperCase(lines) {
        return lines.map((line) => line.toUpperCase())
    }

    static trim(lines) {
        return lines.map((line) => line.trim())
    }

    static trimEnd(lines) {
        return lines.map((line) => line.trimEnd())
    }

    static trimStart(lines) {
        return lines.map((line) => line.trimStart())
    }
  }

  function handleCommandEvent(event) {
    let commandName = event.target.value
    let textarea = document.getElementById("text")

    let command = Commands[commandName]
    let lines = textarea.value.split("\n")

    let transformed = command(lines)

    textarea.value = transformed.join("\n")
  }
  </script>
</html>
